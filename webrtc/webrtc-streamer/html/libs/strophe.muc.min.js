/**
 * Minified by jsDelivr using UglifyJS v3.1.10.
 * Original file: /npm/strophejs-plugin-muc@1.1.0/lib/strophe.muc.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("strophe.js")):"function"==typeof define&&define.amd?define(["strophe.js"],e):e(t.window)}(this,function(t){"use strict";var e,n,i={}.hasOwnProperty,o=function(t,e){return function(){return t.apply(e,arguments)}};t.Strophe.addConnectionPlugin("muc",{_connection:null,rooms:{},roomNames:[],init:function(e){return this._connection=e,this._muc_handler=null,t.Strophe.addNamespace("MUC_OWNER",t.Strophe.NS.MUC+"#owner"),t.Strophe.addNamespace("MUC_ADMIN",t.Strophe.NS.MUC+"#admin"),t.Strophe.addNamespace("MUC_USER",t.Strophe.NS.MUC+"#user"),t.Strophe.addNamespace("MUC_ROOMCONF",t.Strophe.NS.MUC+"#roomconfig"),t.Strophe.addNamespace("MUC_REGISTER","jabber:iq:register")},join:function(e,i,o,r,s,c,h,u){var a,l;return l=this.test_append_nick(e,i),a=t.$pres({from:this._connection.jid,to:l}).c("x",{xmlns:t.Strophe.NS.MUC}),null!=h&&(a=a.c("history",h).up()),null!=c&&a.cnode(t.Strophe.xmlElement("password",[],c)),null!=u&&a.up().cnode(u),null==this._muc_handler&&(this._muc_handler=this._connection.addHandler(function(n){return function(i){var o,r,s,c,h,u,a,l,d;if(!(o=i.getAttribute("from")))return!0;if(u=o.split("/")[0],!n.rooms[u])return!0;if(e=n.rooms[u],r={},"message"===i.nodeName)r=e._message_handlers;else if("presence"===i.nodeName&&(d=i.getElementsByTagName("x")).length>0)for(s=0,h=d.length;s<h;s++)if(a=d[s],(l=a.getAttribute("xmlns"))&&l.match(t.Strophe.NS.MUC)){r=e._presence_handlers;break}for(c in r)(0,r[c])(i,e)||delete r[c];return!0}}(this))),this.rooms.hasOwnProperty(e)||(this.rooms[e]=new n(this,e,i,c),r&&this.rooms[e].addHandler("presence",r),o&&this.rooms[e].addHandler("message",o),s&&this.rooms[e].addHandler("roster",s),this.roomNames.push(e)),this._connection.send(a)},leave:function(e,n,i,o){var r,s,c,h;return r=this.roomNames.indexOf(e),delete this.rooms[e],r>=0&&(this.roomNames.splice(r,1),0===this.roomNames.length&&(this._connection.deleteHandler(this._muc_handler),this._muc_handler=null)),h=this.test_append_nick(e,n),c=this._connection.getUniqueId(),s=t.$pres({type:"unavailable",id:c,from:this._connection.jid,to:h}),null!=o&&s.c("status",o),null!=i&&this._connection.addHandler(i,null,"presence",null,c),this._connection.send(s),c},message:function(e,n,i,o,r,s){var c,h,u;return u=this.test_append_nick(e,n),r=r||(null!=n?"chat":"groupchat"),s=s||this._connection.getUniqueId(),(c=t.$msg({to:u,from:this._connection.jid,type:r,id:s}).c("body").t(i)).up(),null!=o&&(c.c("html",{xmlns:t.Strophe.NS.XHTML_IM}).c("body",{xmlns:t.Strophe.NS.XHTML}).h(o),0===c.node.childNodes.length?(h=c.node.parentNode,c.up().up(),c.node.removeChild(h)):c.up().up()),c.c("x",{xmlns:"jabber:x:event"}).c("composing"),this._connection.send(c),s},groupchat:function(t,e,n,i){return this.message(t,null,e,n,void 0,i)},invite:function(e,n,i){var o,r;return r=this._connection.getUniqueId(),o=t.$msg({from:this._connection.jid,to:e,id:r}).c("x",{xmlns:t.Strophe.NS.MUC_USER}).c("invite",{to:n}),null!=i&&o.c("reason",i),this._connection.send(o),r},multipleInvites:function(e,n,i){var o,r,s,c,h;for(c=this._connection.getUniqueId(),r=t.$msg({from:this._connection.jid,to:e,id:c}).c("x",{xmlns:t.Strophe.NS.MUC_USER}),o=0,s=n.length;o<s;o++)h=n[o],r.c("invite",{to:h}),null!=i&&(r.c("reason",i),r.up()),r.up();return this._connection.send(r),c},directInvite:function(e,n,i,o){var r,s,c;return c=this._connection.getUniqueId(),r={xmlns:"jabber:x:conference",jid:e},null!=i&&(r.reason=i),null!=o&&(r.password=o),s=t.$msg({from:this._connection.jid,to:n,id:c}).c("x",r),this._connection.send(s),c},queryOccupants:function(e,n,i){var o,r;return o={xmlns:t.Strophe.NS.DISCO_ITEMS},r=t.$iq({from:this._connection.jid,to:e,type:"get"}).c("query",o),this._connection.sendIQ(r,n,i)},configure:function(e,n,i){var o,r;return o=t.$iq({to:e,type:"get"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}),r=o.tree(),this._connection.sendIQ(r,n,i)},cancelConfigure:function(e){var n,i;return n=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"cancel"}),i=n.tree(),this._connection.sendIQ(i)},saveConfiguration:function(e,n,i,o){var r,s,c,h,u;if(c=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}),void 0!==t.Strophe.x&&void 0!==t.Strophe.x.Form&&n instanceof t.Strophe.x.Form)n.type="submit",c.cnode(n.toXML());else for(c.c("x",{xmlns:"jabber:x:data",type:"submit"}),s=0,h=n.length;s<h;s++)r=n[s],c.cnode(r).up();return u=c.tree(),this._connection.sendIQ(u,i,o)},createInstantRoom:function(e,n,i){var o;return o=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"}),this._connection.sendIQ(o.tree(),n,i)},createConfiguredRoom:function(e,n,o,r){var s,c,h;(c=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"})).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up();for(s in n)i.call(n,s)&&(h=n[s],c.c("field",{var:s}).c("value").t(h).up().up());return this._connection.sendIQ(c.tree(),o,r)},setTopic:function(e,n){var i;return i=t.$msg({to:e,from:this._connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(n),this._connection.send(i.tree())},_modifyPrivilege:function(e,n,i,o,r){var s;return s=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_ADMIN}).cnode(n.node),null!=i&&s.c("reason",i),this._connection.sendIQ(s.tree(),o,r)},modifyRole:function(e,n,i,o,r,s){var c;return c=t.$build("item",{nick:n,role:i}),this._modifyPrivilege(e,c,o,r,s)},kick:function(t,e,n,i,o){return this.modifyRole(t,e,"none",n,i,o)},voice:function(t,e,n,i,o){return this.modifyRole(t,e,"participant",n,i,o)},mute:function(t,e,n,i,o){return this.modifyRole(t,e,"visitor",n,i,o)},op:function(t,e,n,i,o){return this.modifyRole(t,e,"moderator",n,i,o)},deop:function(t,e,n,i,o){return this.modifyRole(t,e,"participant",n,i,o)},modifyAffiliation:function(e,n,i,o,r,s){var c;return c=t.$build("item",{jid:n,affiliation:i}),this._modifyPrivilege(e,c,o,r,s)},ban:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"outcast",n,i,o)},member:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"member",n,i,o)},revoke:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"none",n,i,o)},owner:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"owner",n,i,o)},admin:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"admin",n,i,o)},changeNick:function(e,n){var i,o;return o=this.test_append_nick(e,n),i=t.$pres({from:this._connection.jid,to:o,id:this._connection.getUniqueId()}),this._connection.send(i.tree())},setStatus:function(e,n,i,o){var r,s;return s=this.test_append_nick(e,n),r=t.$pres({from:this._connection.jid,to:s}),null!=i&&r.c("show",i).up(),null!=o&&r.c("status",o),this._connection.send(r.tree())},registrationRequest:function(e,n,i){var o;return o=t.$iq({to:e,from:this._connection.jid,type:"get"}).c("query",{xmlns:t.Strophe.NS.MUC_REGISTER}),this._connection.sendIQ(o,function(t){var e,i,o,r,s,c;for((i=t.getElementsByTagName("field")).length,r={required:[],optional:[]},s=0,c=i.length;s<c;s++)o={var:(e=i[s]).getAttribute("var"),label:e.getAttribute("label"),type:e.getAttribute("type")},e.getElementsByTagName("required").length>0?r.required.push(o):r.optional.push(o);return n(r)},i)},submitRegistrationForm:function(e,n,i,o){var r,s,c;(r=t.$iq({to:e,type:"set"}).c("query",{xmlns:t.Strophe.NS.MUC_REGISTER})).c("x",{xmlns:"jabber:x:data",type:"submit"}),r.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up();for(s in n)c=n[s],r.c("field",{var:s}).c("value").t(c).up().up();return this._connection.sendIQ(r,i,o)},listRooms:function(e,n,i){var o;return o=t.$iq({to:e,from:this._connection.jid,type:"get"}).c("query",{xmlns:t.Strophe.NS.DISCO_ITEMS}),this._connection.sendIQ(o,n,i)},test_append_nick:function(e,n){var i,o;return o=t.Strophe.escapeNode(t.Strophe.getNodeFromJid(e)),i=t.Strophe.getDomainFromJid(e),o+"@"+i+(null!=n?"/"+n:"")}}),n=function(){function n(e,n,i,r){this.client=e,this.name=n,this.nick=i,this.password=r,this._roomRosterHandler=o(this._roomRosterHandler,this),this._addOccupant=o(this._addOccupant,this),this.roster={},this._message_handlers={},this._presence_handlers={},this._roster_handlers={},this._handler_ids=0,this.client.muc&&(this.client=this.client.muc),this.name=t.Strophe.getBareJidFromJid(this.name),this.addHandler("presence",this._roomRosterHandler)}return n.prototype.join=function(t,e,n){return this.client.join(this.name,this.nick,t,e,n,this.password)},n.prototype.leave=function(t,e){return this.client.leave(this.name,this.nick,t,e),delete this.client.rooms[this.name]},n.prototype.message=function(t,e,n,i){return this.client.message(this.name,t,e,n,i)},n.prototype.groupchat=function(t,e){return this.client.groupchat(this.name,t,e)},n.prototype.invite=function(t,e){return this.client.invite(this.name,t,e)},n.prototype.multipleInvites=function(t,e){return this.client.invite(this.name,t,e)},n.prototype.directInvite=function(t,e){return this.client.directInvite(this.name,t,e,this.password)},n.prototype.configure=function(t){return this.client.configure(this.name,t)},n.prototype.cancelConfigure=function(){return this.client.cancelConfigure(this.name)},n.prototype.saveConfiguration=function(t){return this.client.saveConfiguration(this.name,t)},n.prototype.queryOccupants=function(t,e){return this.client.queryOccupants(this.name,t,e)},n.prototype.setTopic=function(t){return this.client.setTopic(this.name,t)},n.prototype.modifyRole=function(t,e,n,i,o){return this.client.modifyRole(this.name,t,e,n,i,o)},n.prototype.kick=function(t,e,n,i){return this.client.kick(this.name,t,e,n,i)},n.prototype.voice=function(t,e,n,i){return this.client.voice(this.name,t,e,n,i)},n.prototype.mute=function(t,e,n,i){return this.client.mute(this.name,t,e,n,i)},n.prototype.op=function(t,e,n,i){return this.client.op(this.name,t,e,n,i)},n.prototype.deop=function(t,e,n,i){return this.client.deop(this.name,t,e,n,i)},n.prototype.modifyAffiliation=function(t,e,n,i,o){return this.client.modifyAffiliation(this.name,t,e,n,i,o)},n.prototype.ban=function(t,e,n,i){return this.client.ban(this.name,t,e,n,i)},n.prototype.member=function(t,e,n,i){return this.client.member(this.name,t,e,n,i)},n.prototype.revoke=function(t,e,n,i){return this.client.revoke(this.name,t,e,n,i)},n.prototype.owner=function(t,e,n,i){return this.client.owner(this.name,t,e,n,i)},n.prototype.admin=function(t,e,n,i){return this.client.admin(this.name,t,e,n,i)},n.prototype.changeNick=function(t){return this.nick=t,this.client.changeNick(this.name,nick)},n.prototype.setStatus=function(t,e){return this.client.setStatus(this.name,this.nick,t,e)},n.prototype.addHandler=function(t,e){var n;switch(n=this._handler_ids++,t){case"presence":this._presence_handlers[n]=e;break;case"message":this._message_handlers[n]=e;break;case"roster":this._roster_handlers[n]=e;break;default:return this._handler_ids--,null}return n},n.prototype.removeHandler=function(t){return delete this._presence_handlers[t],delete this._message_handlers[t],delete this._roster_handlers[t]},n.prototype._addOccupant=function(t){var n;return n=new e(t,this),this.roster[n.nick]=n,n},n.prototype._roomRosterHandler=function(t){var e,i,o,r,s;switch(e=n._parsePresence(t),r=e.nick,o=e.newnick||null,e.type){case"error":return!0;case"unavailable":o&&(e.nick=o,this.roster[r]&&this.roster[o]&&(this.roster[r].update(this.roster[o]),this.roster[o]=this.roster[r]),this.roster[r]&&!this.roster[o]&&(this.roster[o]=this.roster[r].update(e))),delete this.roster[r];break;default:this.roster[r]?this.roster[r].update(e):this._addOccupant(e)}s=this._roster_handlers;for(i in s)(0,s[i])(this.roster,this)||delete this._roster_handlers[i];return!0},n._parsePresence=function(e){var n,i,o,r,s,c,h,u,a,l;for((o={}).nick=t.Strophe.getResourceFromJid(e.getAttribute("from")),o.type=e.getAttribute("type"),o.states=[],r=0,c=(u=e.childNodes).length;r<c;r++)switch((n=u[r]).nodeName){case"error":o.errorcode=n.getAttribute("code"),o.error=null!=(a=n.childNodes[0])?a.nodeName:void 0;break;case"status":o.status=n.textContent||null;break;case"show":o.show=n.textContent||null;break;case"x":if(n.getAttribute("xmlns")===t.Strophe.NS.MUC_USER)for(s=0,h=(l=n.childNodes).length;s<h;s++)switch((i=l[s]).nodeName){case"item":o.affiliation=i.getAttribute("affiliation"),o.role=i.getAttribute("role"),o.jid=i.getAttribute("jid"),o.newnick=i.getAttribute("nick");break;case"status":i.getAttribute("code")&&o.states.push(i.getAttribute("code"))}}return o},n}(),function(){function t(t){this.parse=o(this.parse,this),null!=t&&this.parse(t)}t.prototype.parse=function(t){var e,n,i,o,r,s,c,h,u,a,l,d,p;for(d=t.getElementsByTagName("query")[0].childNodes,this.identities=[],this.features=[],this.x=[],r=0,u=d.length;r<u;r++)switch(i=d[r],n=i.attributes,i.nodeName){case"identity":for(s={},c=0,a=n.length;c<a;c++)s[(e=n[c]).name]=e.textContent;this.identities.push(s);break;case"feature":this.features.push(i.getAttribute("var"));break;case"x":if("FORM_TYPE"===!i.childNodes[0].getAttribute("var")||"hidden"===!i.childNodes[0].getAttribute("type"))break;for(h=0,l=(p=i.childNodes).length;h<l;h++)(o=p[h]).attributes.type||this.x.push({var:o.getAttribute("var"),label:o.getAttribute("label")||"",value:o.firstChild.textContent||""})}return{identities:this.identities,features:this.features,x:this.x}}}(),e=function(){function t(t,e){this.room=e,this.update=o(this.update,this),this.admin=o(this.admin,this),this.owner=o(this.owner,this),this.revoke=o(this.revoke,this),this.member=o(this.member,this),this.ban=o(this.ban,this),this.modifyAffiliation=o(this.modifyAffiliation,this),this.deop=o(this.deop,this),this.op=o(this.op,this),this.mute=o(this.mute,this),this.voice=o(this.voice,this),this.kick=o(this.kick,this),this.modifyRole=o(this.modifyRole,this),this.update(t)}return t.prototype.modifyRole=function(t,e,n,i){return this.room.modifyRole(this.nick,t,e,n,i)},t.prototype.kick=function(t,e,n){return this.room.kick(this.nick,t,e,n)},t.prototype.voice=function(t,e,n){return this.room.voice(this.nick,t,e,n)},t.prototype.mute=function(t,e,n){return this.room.mute(this.nick,t,e,n)},t.prototype.op=function(t,e,n){return this.room.op(this.nick,t,e,n)},t.prototype.deop=function(t,e,n){return this.room.deop(this.nick,t,e,n)},t.prototype.modifyAffiliation=function(t,e,n,i){return this.room.modifyAffiliation(this.jid,t,e,n,i)},t.prototype.ban=function(t,e,n){return this.room.ban(this.jid,t,e,n)},t.prototype.member=function(t,e,n){return this.room.member(this.jid,t,e,n)},t.prototype.revoke=function(t,e,n){return this.room.revoke(this.jid,t,e,n)},t.prototype.owner=function(t,e,n){return this.room.owner(this.jid,t,e,n)},t.prototype.admin=function(t,e,n){return this.room.admin(this.jid,t,e,n)},t.prototype.update=function(t){return this.nick=t.nick||null,this.affiliation=t.affiliation||null,this.role=t.role||null,this.jid=t.jid||null,this.status=t.status||null,this.show=t.show||null,this},t}()});
//# sourceMappingURL=/sm/8dece32f208048565c89caefac55f9824c88f77a440cf157ed594c589da1097c.map